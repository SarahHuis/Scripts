import numpy as np
from sklearn.neighbors import KDTree
import csv
import numpy as np
import math, itertools

def closest_neighbours(coordinates, neighbour_verts):
    tree = []
    for e, b in enumerate(neighbour_verts):

        #print("Suc:", len(neighbour_verts[0]))
        #print("NN:")
        #print(e)
        tmp = []
        for v in range(len(neighbour_verts[e])):
        #for v in enumerate(range(3)):
            vertex = neighbour_verts[e][v]
            coo = coordinates[neighbour_verts[e][v]]
            ind_coo = coordinates[e]
            #print("V:", v)
            #print("Vertex:", vertex)
            #print("Coo:", coo)
            #print("Ind_coo:", ind_coo)
            #print("Ind_coo[1]:", ind_coo[1])
            #print("Coo[1]:", coo[1])
            #dist_YZ = math.sqrt(math.pow((ind_coo[1] - coo[1]), 2) + math.pow((ind_coo[2] - coo[2]), 2)) # (Y1 - Y2) + (Z1 - Z2)
            dist_X = ind_coo[0] - coo[0]
            result = []
            result.append(vertex)
            result.append(dist_X)
            tuple(result)
            #print("Result:", result)
            tmp.append(result)
        print("TMP:", tmp)

#        for i in range(len(tmp)):
#            if tmp[i][1] < tmp[i-1][1]:
#                tmp.insert((i-1), tmp.pop(i))
#                print("Pop:", tmp)
        c = 1
        while c != 0:
            c = 1
            for i in range(len(tmp)):
                if tmp[i][1] < tmp[i-1][1] and i != 0:
                    tmp.insert((i-1), tmp.pop(i))
                    #print("Pop:", tmp)
                    c += 1
            if c == 1:
                c = 0

        tmp_tree = []
        tmp_tree.append(e)
        for i in range(len(tmp)):
            tmp_tree.append(tmp[i][0])
        #print("TMP Tree:", tmp_tree)
        tree.append(tmp_tree)

    print("Tree:", tree)
    return tree



def find_next_vertex(tree, nearest_ind, selected_coordinates, loop_iteration):
    #print("Selected Coordinates Loop:", selected_coordinates)
    c = 1
    #next = nearest_ind[selected_coordinates[loop_iteration], c]
    next = nearest_ind[selected_coordinates[loop_iteration]][c]
    #print("Next:", next)
    # Check if index is used before
    while c < (len(tree)):
        if next not in selected_coordinates:
            #print("Return")
            return next

        elif next in selected_coordinates:
            c += 1
            #next = nearest_ind[selected_coordinates[loop_iteration], c]
            next = nearest_ind[selected_coordinates[loop_iteration]][c]
            #print("Next Else", next)


np.random.seed(0)
#X = [(-1.0, -1.0, -1.0),
#        (-1.0, -1.0, 1.0),
#        (-1.0, 1.0, -1.0),
#        (-1.0, 1.0, 1.0),
#        (1.0, -1.0, -1.0),
#        (1.0, -1.0, 1.0),
#        (1.0, 1.0, -1.0),
#        (1.0, 1.0, 1.0)]

# Coordinates
#X =  [(-1.0, -1.0, -1.0), (-1.0, -1.0, 1.0), (-1.0, 1.0, -1.0), (-1.0, 1.0, 1.0), (1.0, -1.0, -1.0), (1.0, -1.0, 1.0), (1.0, 1.0, -1.0), (1.0, 1.0, 1.0)]
#X = [(0.9510578513145447, -0.30901262164115906, 0.0), (0.8944262266159058, 0.0, 0.44721561670303345), (-0.8944262266159058, 0.0, -0.44721561670303345), (0.276388019323349, 0.8506492376327515, 0.4472198486328125), (-0.26286882162094116, -0.8090116381645203, 0.5257376432418823), (-0.6881893873214722, -0.49999693036079407, -0.5257362127304077), (0.0, 0.9999999403953552, 0.0), (0.16245555877685547, -0.49999526143074036, 0.8506543636322021), (0.6881893873214722, -0.49999693036079407, 0.5257362127304077), (0.8506478667259216, 0.0, -0.5257359147071838), (-0.8506478667259216, 0.0, 0.5257359147071838), (-0.42532268166542053, 0.30901139974594116, 0.8506541848182678), (-0.9510578513145447, 0.30901262164115906, 0.0), (-0.42532268166542053, -0.30901139974594116, 0.8506541848182678), (-0.6881893873214722, 0.49999693036079407, -0.5257362127304077), (0.26286882162094116, -0.8090116381645203, -0.5257376432418823), (0.6881893873214722, 0.49999693036079407, 0.5257362127304077), (-0.276388019323349, 0.8506492376327515, -0.4472198486328125), (0.0, 0.0, 1.0), (0.42532268166542053, -0.30901139974594116, -0.8506541848182678), (0.7236073017120361, -0.5257253050804138, -0.44721952080726624), (0.7236073017120361, 0.5257253050804138, -0.44721952080726624), (0.5877856016159058, -0.8090167045593262, 0.0), (0.42532268166542053, 0.30901139974594116, -0.8506541848182678), (-0.7236073017120361, -0.5257253050804138, 0.44721952080726624), (0.26286882162094116, 0.8090116381645203, -0.5257376432418823), (-0.16245555877685547, -0.49999526143074036, -0.8506544232368469), (-0.9510578513145447, -0.30901262164115906, 0.0), (0.276388019323349, -0.8506492376327515, 0.4472198486328125), (0.0, 0.0, -1.0), (0.5877856016159058, 0.8090167045593262, 0.0), (-0.276388019323349, -0.8506492376327515, -0.4472198486328125), (0.16245555877685547, 0.49999526143074036, 0.8506543636322021), (-0.26286882162094116, 0.8090116381645203, 0.5257376432418823), (0.9510578513145447, 0.30901262164115906, 0.0), (-0.7236073017120361, 0.5257253050804138, 0.44721952080726624), (-0.525729775428772, 0.0, -0.8506516814231873), (-0.16245555877685547, 0.49999526143074036, -0.8506544232368469), (0.0, -0.9999999403953552, 0.0), (-0.5877856016159058, -0.8090167045593262, 0.0), (-0.5877856016159058, 0.8090167045593262, 0.0), (0.525729775428772, 0.0, 0.8506516814231873)]
# Indices of connected vertices
#NN = [[2, 1, 4], [0, 3, 5], [0, 3, 6], [1, 2, 7], [6, 5, 0], [7, 4, 1], [2, 7, 4], [3, 6, 5]]

NN = [[2, 14, 292], [213, 208, 464], [3, 0, 428, 13], [2, 4, 12, 315], [5, 3, 427, 11], [4, 6, 10, 332], [7, 5, 426, 9], [6, 343, 8, 365], [21, 7, 503, 9], [8, 10, 6, 20], [19, 5, 9, 11], [10, 12, 4, 18], [17, 3, 11, 13], [12, 14, 2, 16], [15, 0, 13], [14, 16, 28], [17, 15, 27, 13], [12, 16, 18, 26], [19, 17, 25, 11], [10, 18, 20, 24], [21, 19, 23, 9], [8, 20, 260, 22], [35, 21, 502, 23], [22, 24, 20, 34], [33, 19, 23, 25], [24, 26, 18, 32], [31, 17, 25, 27], [26, 28, 16, 30], [29, 15, 27], [28, 30, 286], [31, 29, 501, 27], [30, 26, 32, 311], [33, 31, 500, 25], [32, 24, 34, 328], [35, 33, 499, 23], [22, 34, 347, 36], [37, 35, 498, 499], [36, 84, 264, 38], [39, 37, 497, 83], [38, 82, 351, 40], [41, 39, 496, 81], [40, 80, 268, 42], [43, 41, 495, 79], [42, 78, 355, 44], [45, 43, 494, 77], [44, 76, 270, 46], [47, 45, 493, 75], [46, 74, 356, 48], [49, 47, 492, 73], [48, 72, 271, 50], [51, 49, 491, 71], [50, 70, 357, 52], [53, 51, 490, 69], [52, 68, 272, 54], [55, 53, 489, 67], [54, 56, 358, 359], [55, 57, 486, 67], [58, 66, 56, 333], [57, 59, 487, 65], [60, 64, 58, 316], [59, 61, 488, 63], [62, 60, 296], [61, 169, 63], [64, 62, 136, 60], [59, 135, 65, 63], [66, 64, 106, 58], [57, 105, 67, 65], [54, 66, 68, 56], [53, 105, 67, 69], [52, 104, 70, 68], [51, 103, 69, 71], [50, 102, 72, 70], [49, 101, 71, 73], [48, 100, 74, 72], [47, 99, 73, 75], [46, 98, 76, 74], [45, 97, 75, 77], [44, 96, 78, 76], [43, 95, 77, 79], [42, 94, 80, 78], [41, 93, 79, 81], [40, 92, 82, 80], [39, 91, 81, 83], [38, 90, 84, 82], [37, 85, 83, 499], [328, 86, 84, 90], [85, 87, 89, 500], [311, 152, 86, 88], [121, 87, 89, 151], [90, 88, 86, 120], [91, 85, 83, 89], [120, 90, 82, 92], [93, 91, 81, 119], [92, 118, 80, 94], [95, 93, 79, 117], [116, 94, 78, 96], [97, 95, 77, 115], [96, 114, 76, 98], [99, 97, 75, 113], [112, 98, 74, 100], [101, 99, 73, 111], [100, 110, 72, 102], [103, 101, 71, 109], [108, 102, 70, 104], [105, 103, 69, 107], [104, 106, 68, 66], [105, 135, 65, 107], [104, 134, 108, 106], [103, 133, 107, 109], [102, 132, 110, 108], [101, 131, 109, 111], [100, 130, 112, 110], [99, 129, 111, 113], [98, 128, 114, 112], [97, 127, 113, 115], [96, 126, 116, 114], [95, 125, 115, 117], [94, 124, 118, 116], [93, 123, 117, 119], [92, 122, 120, 118], [91, 121, 119, 89], [150, 88, 120, 122], [123, 121, 119, 149], [122, 148, 118, 124], [125, 123, 117, 147], [146, 124, 116, 126], [127, 125, 115, 145], [126, 144, 114, 128], [129, 127, 113, 143], [142, 128, 112, 130], [131, 129, 111, 141], [130, 140, 110, 132], [133, 131, 109, 139], [138, 132, 108, 134], [135, 133, 107, 137], [134, 136, 106, 64], [135, 169, 63, 137], [134, 168, 138, 136], [133, 167, 137, 139], [132, 166, 140, 138], [131, 165, 139, 141], [130, 164, 142, 140], [129, 163, 141, 143], [128, 162, 144, 142], [127, 161, 143, 145], [126, 160, 146, 144], [125, 159, 145, 147], [124, 158, 148, 146], [123, 157, 147, 149], [122, 156, 150, 148], [121, 155, 149, 151], [88, 154, 152, 150], [87, 153, 151, 501], [286, 152, 154], [155, 153, 151], [154, 150, 156], [157, 155, 149], [156, 148, 158], [159, 157, 147], [158, 146, 160], [161, 159, 145], [160, 144, 162], [163, 161, 143], [162, 142, 164], [165, 163, 141], [164, 140, 166], [167, 165, 139], [166, 138, 168], [169, 167, 137], [168, 136, 62], [343, 370, 381], [260, 370, 284], [284, 347, 373], [264, 373, 288], [288, 351, 376], [268, 376, 291], [291, 355, 378], [270, 378, 293], [293, 356, 379], [271, 379, 294], [294, 357, 380], [272, 380, 295], [295, 358, 383], [296, 382, 384], [316, 382, 402, 403], [333, 402, 417, 418], [359, 417, 273, 274], [273, 383, 298], [384, 297, 299], [297, 403, 317, 318], [317, 418, 334, 335], [274, 334, 360, 361], [298, 360, 386], [299, 385, 387], [318, 385, 404, 405], [335, 404, 419, 420], [361, 419, 275, 276], [275, 386, 301], [387, 300, 302], [300, 405, 319, 320], [319, 420, 336, 337], [276, 336, 362, 363], [301, 362, 389], [302, 388, 390], [320, 388, 406, 407], [337, 406, 421, 422], [363, 421, 277, 278], [277, 389, 304], [390, 303, 1], [303, 407, 321, 322], [321, 422, 338, 339], [278, 338, 364, 366], [304, 364, 392], [1, 391, 393], [322, 391, 408, 409], [339, 408, 423, 424], [366, 423, 279, 280], [279, 392, 306], [393, 305, 307], [305, 409, 323, 324], [323, 424, 340, 341], [280, 340, 367, 368], [306, 367, 342], [307, 344, 394], [324, 394, 410, 411], [341, 410, 395, 396], [368, 395, 281, 282], [281, 342, 259], [344, 258, 261], [258, 411, 325, 326], [325, 396, 308, 309], [282, 308, 369, 371], [259, 369, 346], [261, 345, 348], [326, 345, 412, 413], [309, 412, 397, 398], [371, 397, 283, 285], [283, 346, 263], [348, 262, 265], [262, 413, 327, 329], [327, 398, 310, 312], [285, 310, 372, 374], [263, 372, 350], [265, 349, 352], [329, 349, 414, 415], [312, 414, 399, 400], [374, 399, 287, 289], [287, 350, 267], [352, 266, 269], [266, 415, 330, 331], [330, 400, 313, 314], [289, 313, 375, 377], [267, 375, 354], [269, 292, 353], [315, 331, 353, 416], [314, 332, 416, 401], [365, 377, 401, 290], [290, 354, 381], [229, 228, 448, 452], [232, 227, 449], [171, 21, 502, 503], [233, 228, 448], [239, 238, 440, 444], [242, 237, 441], [173, 37, 497, 498], [243, 238, 440], [249, 248, 432, 436], [252, 247, 433], [175, 41, 495, 496], [253, 248, 432], [177, 45, 493, 494], [179, 49, 491, 492], [181, 53, 489, 490], [187, 186, 481, 485], [191, 186, 481, 482], [197, 196, 473, 477], [201, 196, 473, 474], [207, 206, 465, 469], [211, 206, 465, 466], [217, 216, 457, 461], [221, 216, 457, 458], [227, 226, 449, 453], [231, 226, 449, 450], [237, 236, 441, 445], [172, 171, 502], [241, 236, 441, 442], [153, 29, 501], [247, 246, 433, 437], [174, 173, 497], [251, 246, 433, 434], [257, 256, 425, 429], [176, 175, 495], [253, 0, 428], [178, 177, 493], [180, 179, 491], [182, 181, 489], [183, 61, 488], [189, 188, 480, 484], [192, 187, 481], [193, 188, 480], [199, 198, 472, 476], [202, 197, 473], [203, 198, 472], [209, 208, 464, 468], [212, 207, 465], [219, 218, 456, 460], [222, 217, 457], [223, 218, 456], [231, 230, 446, 450], [235, 230, 446, 447], [241, 240, 438, 442], [87, 31, 500, 501], [245, 240, 438, 439], [251, 250, 430, 434], [255, 250, 430, 431], [254, 3, 427, 428], [184, 59, 487, 488], [190, 189, 479, 483], [194, 189, 479, 480], [200, 199, 471, 475], [204, 199, 471, 472], [210, 209, 463, 467], [214, 209, 463, 464], [220, 219, 455, 459], [224, 219, 455, 456], [230, 229, 447, 451], [234, 229, 447, 448], [240, 239, 439, 443], [85, 33, 499, 500], [244, 239, 439, 440], [250, 249, 431, 435], [254, 249, 431, 432], [255, 5, 426, 427], [185, 57, 486, 487], [191, 190, 478, 482], [195, 190, 478, 479], [201, 200, 470, 474], [205, 200, 470, 471], [211, 210, 462, 466], [215, 210, 462, 463], [221, 220, 454, 458], [225, 220, 454, 455], [227, 222, 453], [170, 7, 425, 503], [228, 223, 452], [234, 233, 444, 448], [237, 232, 445], [172, 35, 498, 502], [238, 233, 444], [244, 243, 436, 440], [247, 242, 437], [174, 39, 496, 497], [248, 243, 436], [254, 253, 428, 432], [257, 252, 429], [176, 43, 494, 495], [178, 47, 492, 493], [180, 51, 490, 491], [182, 55, 485, 489], [186, 55, 485, 486], [192, 191, 477, 481], [196, 191, 477, 478], [202, 201, 469, 473], [206, 201, 469, 470], [212, 211, 461, 465], [256, 7, 425, 426], [216, 211, 461, 462], [222, 221, 453, 457], [226, 221, 453, 454], [232, 231, 445, 449], [171, 170, 503], [236, 231, 445, 446], [242, 241, 437, 441], [173, 172, 498], [246, 241, 437, 438], [252, 251, 429, 433], [175, 174, 496], [256, 251, 429, 430], [177, 176, 494], [179, 178, 492], [181, 180, 490], [257, 170, 425], [184, 183, 484, 488], [187, 182, 485], [188, 183, 484], [194, 193, 476, 480], [197, 192, 477], [198, 193, 476], [204, 203, 468, 472], [207, 202, 469], [208, 203, 468], [214, 213, 460, 464], [217, 212, 461], [218, 213, 460], [224, 223, 452, 456], [226, 225, 450, 454], [230, 225, 450, 451], [236, 235, 442, 446], [240, 235, 442, 443], [246, 245, 434, 438], [250, 245, 434, 435], [256, 255, 426, 430], [185, 184, 483, 487], [189, 184, 483, 484], [195, 194, 475, 479], [199, 194, 475, 476], [205, 204, 467, 471], [209, 204, 467, 468], [215, 214, 459, 463], [219, 214, 459, 460], [225, 224, 451, 455], [229, 224, 451, 452], [235, 234, 443, 447], [239, 234, 443, 444], [245, 244, 435, 439], [249, 244, 435, 436], [255, 254, 427, 431], [186, 185, 482, 486], [190, 185, 482, 483], [196, 195, 474, 478], [200, 195, 474, 475], [206, 205, 466, 470], [210, 205, 466, 467], [216, 215, 458, 462], [220, 215, 458, 459], [381, 365, 290, 343], [365, 332, 401, 6], [332, 315, 416, 4], [315, 292, 353, 2], [354, 377, 375, 290], [377, 314, 313, 401], [314, 331, 330, 416], [331, 269, 266, 353], [267, 289, 287, 375], [289, 400, 399, 313], [400, 415, 414, 330], [415, 352, 349, 266], [350, 374, 372, 287], [374, 312, 310, 399], [312, 329, 327, 414], [329, 265, 262, 349], [263, 285, 283, 372], [285, 398, 397, 310], [398, 413, 412, 327], [413, 348, 345, 262], [346, 371, 369, 283], [371, 309, 308, 397], [309, 326, 325, 412], [326, 261, 258, 345], [259, 282, 281, 369], [282, 396, 395, 308], [396, 411, 410, 325], [411, 344, 394, 258], [342, 368, 367, 281], [368, 341, 340, 395], [341, 324, 323, 410], [324, 307, 305, 394], [306, 280, 279, 367], [280, 424, 423, 340], [424, 409, 408, 323], [409, 393, 391, 305], [392, 366, 364, 279], [366, 339, 338, 423], [339, 322, 321, 408], [322, 1, 303, 391], [304, 278, 277, 364], [278, 422, 421, 338], [422, 407, 406, 321], [407, 390, 388, 303], [389, 363, 362, 277], [363, 337, 336, 421], [337, 320, 319, 406], [320, 302, 300, 388], [301, 276, 275, 362], [276, 420, 419, 336], [420, 405, 404, 319], [405, 387, 385, 300], [386, 361, 360, 275], [361, 335, 334, 419], [335, 318, 317, 404], [318, 299, 297, 385], [298, 274, 273, 360], [274, 418, 417, 334], [418, 403, 402, 317], [403, 384, 382, 297], [383, 359, 358, 273], [359, 333, 56, 417], [333, 316, 58, 402], [316, 296, 60, 382], [295, 54, 272, 358], [380, 52, 357, 272], [294, 50, 271, 357], [379, 48, 356, 271], [293, 46, 270, 356], [378, 44, 355, 270], [291, 42, 268, 355], [376, 40, 351, 268], [288, 38, 264, 351], [373, 36, 347, 264], [36, 328, 34, 84], [328, 311, 32, 86], [311, 286, 30, 152], [284, 22, 260, 347], [370, 8, 343, 260]]
X = [(0.0742424875497818, 0.001968987751752138, 0.014395554549992085), (-0.038539186120033264, -0.059253983199596405, 0.010387245565652847), (0.06981860846281052, 0.0019702385179698467, 0.019281409680843353), (0.06481559574604034, 0.0020545327570289373, 0.02357141114771366), (0.058497652411460876, 0.0020888266153633595, 0.02575833722949028), (0.0518336147069931, 0.002324380911886692, 0.026243485510349274), (0.044938381761312485, 0.0023969952017068863, 0.02488940954208374), (0.03862082585692406, 0.0027236754540354013, 0.021829210221767426), (0.038211215287446976, 0.006289650220423937, 0.02254241704940796), (0.04434797167778015, 0.0065588997676968575, 0.025532715022563934), (0.051029808819293976, 0.007079677656292915, 0.026857875287532806), (0.0576310008764267, 0.007518763653934002, 0.026268627494573593), (0.06384138762950897, 0.008025756105780602, 0.023968666791915894), (0.06881138682365417, 0.008445415645837784, 0.0196397602558136), (0.07318265736103058, 0.008835956454277039, 0.014704377390444279), (0.07147563993930817, 0.015567455440759659, 0.014321096241474152), (0.06732114404439926, 0.0148307578638196, 0.01935547962784767), (0.06254998594522476, 0.013946928083896637, 0.0237831249833107), (0.05662273243069649, 0.012935508042573929, 0.02637847512960434), (0.050225406885147095, 0.011856362223625183, 0.027273349463939667), (0.04372890293598175, 0.010703391395509243, 0.0261831171810627), (0.0377107709646225, 0.009810267947614193, 0.023406969383358955), (0.0362183079123497, 0.013957880437374115, 0.023739509284496307), (0.041937634348869324, 0.015476906672120094, 0.026403512805700302), (0.048102207481861115, 0.017234787344932556, 0.027414921671152115), (0.054332174360752106, 0.01908733695745468, 0.02652706578373909), (0.060111746191978455, 0.02078605815768242, 0.023930225521326065), (0.06483402848243713, 0.022191742435097694, 0.019362986087799072), (0.06894838809967041, 0.023376118391752243, 0.014185678213834763), (0.06603056192398071, 0.0310299564152956, 0.013651274144649506), (0.062040600925683975, 0.029432818293571472, 0.018980424851179123), (0.05745829641819, 0.027542363852262497, 0.023702554404735565), (0.05194113776087761, 0.02519790083169937, 0.026397153735160828), (0.04597915709018707, 0.022615056484937668, 0.027387112379074097), (0.04014086723327637, 0.02024277299642563, 0.026588652282953262), (0.034692052751779556, 0.01808755099773407, 0.024135813117027283), (0.03231384605169296, 0.021476764231920242, 0.023947758600115776), (0.029863405972719193, 0.024819208309054375, 0.023909995332360268), (0.026616904884576797, 0.027954062446951866, 0.023794706910848618), (0.023285992443561554, 0.030999479815363884, 0.023898810148239136), (0.01967087760567665, 0.033205822110176086, 0.023792609572410583), (0.016005903482437134, 0.035329848527908325, 0.02386174350976944), (0.011804926209151745, 0.03668341040611267, 0.02360513061285019), (0.007571765221655369, 0.03795516490936279, 0.023509465157985687), (0.002935030497610569, 0.03839180991053581, 0.023147888481616974), (-0.0017192187951877713, 0.03873864561319351, 0.02295200154185295), (-0.0062551070004701614, 0.03832809254527092, 0.02254420891404152), (-0.0107935331761837, 0.03782787546515465, 0.02229601889848709), (-0.01477037463337183, 0.03676043450832367, 0.02181435562670231), (-0.01873343251645565, 0.03557206317782402, 0.021552326157689095), (-0.022258928045630455, 0.03358985483646393, 0.021305188536643982), (-0.02572556957602501, 0.031491827219724655, 0.021306253969669342), (-0.02887420728802681, 0.028518080711364746, 0.021043969318270683), (-0.03193656727671623, 0.02544434927403927, 0.021043594926595688), (-0.03403262048959732, 0.021675191819667816, 0.02091102860867977), (-0.036027319729328156, 0.01785043254494667, 0.021010853350162506), (-0.04201759025454521, 0.02057686820626259, 0.0234709233045578), (-0.048378847539424896, 0.02347434312105179, 0.02418363094329834), (-0.05448883771896362, 0.026512511074543, 0.023088397458195686), (-0.06014396622776985, 0.029370449483394623, 0.020329125225543976), (-0.0647687166929245, 0.03150669485330582, 0.01584768481552601), (-0.06888129562139511, 0.03342249616980553, 0.010802768170833588), (-0.06494833528995514, 0.04057779163122177, 0.0111915972083807), (-0.06107601895928383, 0.038190897554159164, 0.016210924834012985), (-0.05672633647918701, 0.035524941980838776, 0.02066704072058201), (-0.051323436200618744, 0.032087065279483795, 0.023283904418349266), (-0.04552416503429413, 0.028435710817575455, 0.024229615926742554), (-0.03960003703832626, 0.02494252659380436, 0.02341797575354576), (-0.037144970148801804, 0.029288358986377716, 0.023510169237852097), (-0.033519238233566284, 0.03285708650946617, 0.023528823629021645), (-0.029864083975553513, 0.0363878570497036, 0.02371218241751194), (-0.025757916271686554, 0.03878067806363106, 0.023773107677698135), (-0.0216353889554739, 0.04112764820456505, 0.024013301357626915), (-0.016927391290664673, 0.042519669979810715, 0.024324286729097366), (-0.012220388278365135, 0.04386545717716217, 0.024781858548521996), (-0.007011409383267164, 0.04444634169340134, 0.02505332976579666), (-0.0018056276021525264, 0.0449945405125618, 0.025406431406736374), (0.0035090516321361065, 0.0445849671959877, 0.025664079934358597), (0.008815759792923927, 0.0441436842083931, 0.02599226124584675), (0.013714231550693512, 0.042550086975097656, 0.02610038034617901), (0.018601227551698685, 0.04092816635966301, 0.026266269385814667), (0.022865723818540573, 0.038311637938022614, 0.026235079392790794), (0.027112584561109543, 0.035665325820446014, 0.0263056643307209), (0.030900733545422554, 0.03201518952846527, 0.02627617120742798), (0.03466014564037323, 0.028331268578767776, 0.026385340839624405), (0.03981756791472435, 0.03211565688252449, 0.0271269790828228), (0.04497829079627991, 0.036128588020801544, 0.026056382805109024), (0.049758441746234894, 0.03979577124118805, 0.02330232411623001), (0.04466501623392105, 0.04512316361069679, 0.02326374128460884), (0.04025778919458389, 0.04094245657324791, 0.025991518050432205), (0.03551094979047775, 0.036392297595739365, 0.0270432997494936), (0.031204327940940857, 0.04066893458366394, 0.026959657669067383), (0.026296261698007584, 0.04378589242696762, 0.026946425437927246), (0.021387627348303795, 0.04690173268318176, 0.026907414197921753), (0.01579878479242325, 0.04882602393627167, 0.026846572756767273), (0.010210242122411728, 0.050745464861392975, 0.02668619155883789), (0.004204181954264641, 0.051213979721069336, 0.026431497186422348), (-0.0017987042665481567, 0.05167881026864052, 0.026105284690856934), (-0.007709442172199488, 0.05101785063743591, 0.025846242904663086), (-0.01361814234405756, 0.05035628378391266, 0.025545507669448853), (-0.019123539328575134, 0.048734113574028015, 0.02514822781085968), (-0.024629857391119003, 0.04711199924349785, 0.02476361393928528), (-0.029422052204608917, 0.04436945170164108, 0.024559184908866882), (-0.034216731786727905, 0.041627801954746246, 0.024408042430877686), (-0.03844311088323593, 0.037512436509132385, 0.024341851472854614), (-0.04266948997974396, 0.03339707851409912, 0.024275779724121094), (-0.048074476420879364, 0.03761862963438034, 0.023288752883672714), (-0.043286338448524475, 0.04227159544825554, 0.023473970592021942), (-0.03842826932668686, 0.046851880848407745, 0.023455049842596054), (-0.032976966351270676, 0.05001503974199295, 0.023669812828302383), (-0.027493614703416824, 0.05312288552522659, 0.02377336286008358), (-0.021269382908940315, 0.055069781839847565, 0.024264423176646233), (-0.015015468001365662, 0.056947775185108185, 0.024608589708805084), (-0.00843164324760437, 0.057700783014297485, 0.024958157911896706), (-0.0018332607578486204, 0.05836798995733261, 0.025113284587860107), (0.004911486990749836, 0.05789671838283539, 0.025477010756731033), (0.011655023321509361, 0.057318419218063354, 0.025603026151657104), (0.017976028844714165, 0.055179379880428314, 0.02582434192299843), (0.024257490411400795, 0.052922323346138, 0.02576802670955658), (0.029894988983869553, 0.049348339438438416, 0.02586125209927559), (0.03548065572977066, 0.045694660395383835, 0.02576555870473385), (0.03942720219492912, 0.0502958707511425, 0.022897787392139435), (0.033230945467948914, 0.054484762251377106, 0.023112107068300247), (0.02690671756863594, 0.05848081037402153, 0.022963255643844604), (0.020017221570014954, 0.06107515096664429, 0.023136606439948082), (0.013036081567406654, 0.06340096890926361, 0.022853557020425797), (0.005623536184430122, 0.06411927938461304, 0.022861091420054436), (-0.0017981943674385548, 0.06458893418312073, 0.022462092339992523), (-0.009032092988491058, 0.0639508068561554, 0.022399146109819412), (-0.016233298927545547, 0.06310607492923737, 0.021987438201904297), (-0.023207366466522217, 0.06101040914654732, 0.02171892300248146), (-0.03010505810379982, 0.05873545631766319, 0.021129146218299866), (-0.03627253323793411, 0.05530773103237152, 0.02113451063632965), (-0.042345792055130005, 0.05172748491168022, 0.020843960344791412), (-0.047813158482313156, 0.046738386154174805, 0.020941119641065598), (-0.05310099571943283, 0.041568659245967865, 0.020616482943296432), (-0.057066433131694794, 0.044699765741825104, 0.016129307448863983), (-0.05140204727649689, 0.05030573531985283, 0.01648917980492115), (-0.045465193688869476, 0.055633433163166046, 0.016369670629501343), (-0.03889041021466255, 0.059551313519477844, 0.016721148043870926), (-0.032165855169296265, 0.06322106719017029, 0.01672123186290264), (-0.02476583793759346, 0.06577952951192856, 0.0173034630715847), (-0.01725355163216591, 0.06805544346570969, 0.017515290528535843), (-0.009525001049041748, 0.06900357455015182, 0.017943497747182846), (-0.0017531942576169968, 0.06963687390089035, 0.017980355769395828), (0.006211615167558193, 0.06914922595024109, 0.018386632204055786), (0.014154385775327682, 0.0682920292019844, 0.01834169775247574), (0.021666262298822403, 0.06582492589950562, 0.0186171717941761), (0.029038667678833008, 0.06296467036008835, 0.018389999866485596), (0.035830527544021606, 0.05872519314289093, 0.01852285861968994), (0.0424315519630909, 0.054200612008571625, 0.01825237274169922), (0.048111699521541595, 0.04865380376577377, 0.018654106184840202), (0.05356725677847862, 0.042871952056884766, 0.018682457506656647), (0.05691833049058914, 0.045563992112874985, 0.013502027839422226), (0.0511515811085701, 0.051765039563179016, 0.013489561155438423), (0.04506724327802658, 0.05763820558786392, 0.013047710061073303), (0.03812246397137642, 0.06247717887163162, 0.013378100469708443), (0.03091559000313282, 0.06692701578140259, 0.013257566839456558), (0.023134995251893997, 0.07003933191299438, 0.01353917084634304), (0.015163405798375607, 0.07262461632490158, 0.013268180191516876), (0.00675743306055665, 0.07361596822738647, 0.013345090672373772), (-0.00168234680313617, 0.07410454005002975, 0.012920275330543518), (-0.009930931031703949, 0.07348999381065369, 0.012910237535834312), (-0.018122954294085503, 0.07243919372558594, 0.012459184974431992), (-0.0261235311627388, 0.07002168893814087, 0.012320363894104958), (-0.0339713916182518, 0.06720037758350372, 0.011751063168048859), (-0.041205622255802155, 0.06332097947597504, 0.011744383722543716), (-0.04822131618857384, 0.05908055230975151, 0.01131688803434372), (-0.05458785966038704, 0.053477391600608826, 0.01146739162504673), (-0.06057767570018768, 0.04748436063528061, 0.011071573942899704), (0.028953393921256065, 0.0030180737376213074, 0.011734011583030224), (0.028515134006738663, 0.008212120272219181, 0.013125170022249222), (0.026223260909318924, 0.014811140485107899, 0.014608122408390045), (0.022730574011802673, 0.01980571076273918, 0.014717746526002884), (0.017690131440758705, 0.024143431335687637, 0.014687968418002129), (0.012119865044951439, 0.027071557939052582, 0.014509882777929306), (0.0055486285127699375, 0.02888803370296955, 0.014021459966897964), (-0.001712690107524395, 0.029444314539432526, 0.01336100697517395), (-0.008323673158884048, 0.029102912172675133, 0.01287161000072956), (-0.013917083851993084, 0.027396637946367264, 0.012355754151940346), (-0.019191132858395576, 0.02415614388883114, 0.012144345790147781), (-0.02380029484629631, 0.019634107127785683, 0.011876150965690613), (-0.026729969307780266, 0.013816867023706436, 0.01185787096619606), (-0.07405717670917511, 0.017384788021445274, 0.010618291795253754), (-0.06462960690259933, 0.015255582518875599, 0.020241916179656982), (-0.05161827802658081, 0.012693652883172035, 0.02406710386276245), (-0.038409266620874405, 0.009945061057806015, 0.0209109615534544), (-0.02844066545367241, 0.008113164454698563, 0.011867642402648926), (-0.07606569677591324, 0.0014159251004457474, 0.01039627194404602), (-0.06629288196563721, 0.001448052003979683, 0.020136192440986633), (-0.05278916656970978, 0.0015028160996735096, 0.023936092853546143), (-0.039090417325496674, 0.0017415278125554323, 0.02092690020799637), (-0.028877805918455124, 0.0021258292254060507, 0.011989634484052658), (-0.07377535104751587, -0.014538555406033993, 0.010568112134933472), (-0.06424742192029953, -0.012324594892561436, 0.020242929458618164), (-0.051064666360616684, -0.009384469129145145, 0.02417755126953125), (-0.03769354522228241, -0.006219259928911924, 0.021206870675086975), (-0.027825919911265373, -0.003732707817107439, 0.012249503284692764), (-0.06775075197219849, -0.02973652072250843, 0.010869108140468597), (-0.058952659368515015, -0.025519177317619324, 0.020553190261125565), (-0.046794477850198746, -0.019746705889701843, 0.024447694420814514), (-0.034467749297618866, -0.013777635991573334, 0.021512120962142944), (-0.02540038898587227, -0.00927756167948246, 0.012398339807987213), (-0.05828341841697693, -0.04309791699051857, 0.010169319808483124), (-0.05031270161271095, -0.03720200061798096, 0.02003002166748047), (-0.039703819900751114, -0.02889370732009411, 0.023893088102340698), (-0.028983144089579582, -0.020475655794143677, 0.02084309607744217), (-0.02107364311814308, -0.014210979454219341, 0.011509101837873459), (-0.04551795497536659, -0.05482140928506851, 0.010369338095188141), (-0.039386238902807236, -0.047342054545879364, 0.02005084604024887), (-0.030923951417207718, -0.036906998604536057, 0.02375781536102295), (-0.022521547973155975, -0.026315700262784958, 0.02057556062936783), (-0.016247238963842392, -0.018385520204901695, 0.01119447685778141), (-0.0313415452837944, -0.06329905986785889, 0.009959936141967773), (-0.02708440274000168, -0.05454949662089348, 0.01972903311252594), (-0.021240822970867157, -0.04251546412706375, 0.023609071969985962), (-0.01526497770100832, -0.03032260201871395, 0.02053288370370865), (-0.010772869922220707, -0.021191200241446495, 0.011200286448001862), (-0.015913482755422592, -0.06821621209383011, 0.010207347571849823), (-0.013634887523949146, -0.05871971324086189, 0.020068787038326263), (-0.010371096432209015, -0.0456523634493351, 0.023975729942321777), (-0.0070964498445391655, -0.03251969814300537, 0.020791038870811462), (-0.004669934511184692, -0.02269113063812256, 0.011475086212158203), (0.0007938810740597546, -0.06924745440483093, 0.01081305742263794), (0.0009364448487758636, -0.05958399921655655, 0.020609289407730103), (0.0011337011819705367, -0.046358413994312286, 0.02438667230308056), (0.001404148293659091, -0.03296372666954994, 0.021014802157878876), (0.001696213847026229, -0.022863510996103287, 0.01184074580669403), (0.017167208716273308, -0.06662982702255249, 0.0118989497423172), (0.015235884115099907, -0.05718419700860977, 0.021650463342666626), (0.012466349638998508, -0.04429565742611885, 0.025300204753875732), (0.009777799248695374, -0.03131753206253052, 0.02177572250366211), (0.007877439260482788, -0.021883010864257812, 0.012034893035888672), (0.032728854566812515, -0.060886405408382416, 0.012303434312343597), (0.02881360426545143, -0.052108779549598694, 0.021917574107646942), (0.02337118610739708, -0.04022843763232231, 0.025315256789326668), (0.01789012737572193, -0.028388693928718567, 0.021567989140748978), (0.01384507305920124, -0.019908357411623, 0.011696543544530869), (0.046721626073122025, -0.051974717527627945, 0.01204528659582138), (0.04095912724733353, -0.0445038303732872, 0.021443888545036316), (0.03300066292285919, -0.03434032201766968, 0.024575024843215942), (0.024845562875270844, -0.024248722940683365, 0.020799092948436737), (0.018777191638946533, -0.017004013061523438, 0.01103818416595459), (0.058298155665397644, -0.04050304368138313, 0.012154720723628998), (0.050737131386995316, -0.034973274916410446, 0.021519333124160767), (0.04051601514220238, -0.026991311460733414, 0.024424510076642036), (0.030170582234859467, -0.01900418847799301, 0.020723659545183182), (0.022565962746739388, -0.013275198638439178, 0.011100493371486664), (0.06668254733085632, -0.027276599779725075, 0.01144217699766159), (0.05801915377378464, -0.02325933799147606, 0.020992547273635864), (0.04616681858897209, -0.01769181713461876, 0.024302508682012558), (0.034335650503635406, -0.012114863842725754, 0.020670585334300995), (0.025703178718686104, -0.00807634275406599, 0.01110811810940504), (0.0717625617980957, -0.0125807523727417, 0.011302471160888672), (0.062468912452459335, -0.010545306839048862, 0.020871208980679512), (0.049711644649505615, -0.007550101727247238, 0.02422591671347618), (0.03695985674858093, -0.00454782135784626, 0.020652547478675842), (0.02768903411924839, -0.002370433183386922, 0.011094272136688232), (0.016260573640465736, -0.06221051514148712, 0.017080338671803474), (0.004797446541488171, -0.022428806871175766, 0.011880004778504372), (0.032769955694675446, 0.008876102045178413, 0.018593817949295044), (0.025031518191099167, -0.06400255858898163, 0.012360204011201859), (0.044029600918293, -0.048469796776771545, 0.017043881118297577), (0.016347430646419525, -0.018536854535341263, 0.01128315832465887), (0.02603009343147278, 0.022100716829299927, 0.01963648572564125), (0.05267792195081711, -0.04641076549887657, 0.012342296540737152), (0.06262895464897156, -0.02539130486547947, 0.016521522775292397), (0.024209998548030853, -0.010721160098910332, 0.011016502045094967), (0.013910364359617233, 0.030884839594364166, 0.019528135657310486), (0.06928457319736481, -0.01994950883090496, 0.01143854483962059), (-0.0017432927852496505, 0.033738747239112854, 0.0184982568025589), (-0.01620521768927574, 0.03117670863866806, 0.0172903910279274), (-0.027614787220954895, 0.022343425080180168, 0.016809063032269478), (-0.03312786668539047, 0.008971316739916801, 0.016728511080145836), (-0.038803912699222565, 0.005847567226737738, 0.02080727368593216), (-0.032470762729644775, -0.004880435764789581, 0.017073005437850952), (-0.03610602393746376, -0.010011645033955574, 0.02130100503563881), (-0.02477492205798626, -0.017144478857517242, 0.016524283215403557), (-0.025793472304940224, -0.023435965180397034, 0.020595470443367958), (-0.012897493317723274, -0.025457244366407394, 0.01621823012828827), (-0.01119239442050457, -0.03147801756858826, 0.020547576248645782), (0.0015138082671910524, -0.0276041142642498, 0.01676734909415245), (0.005603098310530186, -0.032172780483961105, 0.0213314201682806), (0.015739010646939278, -0.023820700123906136, 0.01696658506989479), (0.027426548302173615, 0.011544357053935528, 0.01380963996052742), (0.021389514207839966, -0.026373591274023056, 0.0210840106010437), (0.06168501824140549, 0.03843139857053757, 0.01381070725619793), (0.026108190417289734, -0.015932748094201088, 0.016240805387496948), (0.020271826535463333, 0.022045385092496872, 0.014613124541938305), (0.03230125457048416, -0.015589404851198196, 0.020596427842974663), (0.03202195465564728, -0.0034083365462720394, 0.01617838442325592), (0.008861782029271126, 0.028057729825377464, 0.01418505422770977), (0.07321963459253311, -0.005389511585235596, 0.013068467378616333), (-0.005016766954213381, 0.029347337782382965, 0.01304576825350523), (-0.016604237258434296, 0.02586492709815502, 0.012143520638346672), (-0.025352707132697105, 0.016769934445619583, 0.01175746414810419), (-0.07166887074708939, 0.025465641170740128, 0.010921526700258255), (-0.07146666198968887, 0.001429128460586071, 0.015554388053715229), (-0.028743822127580643, 0.005123705603182316, 0.011832082644104958), (-0.07515086233615875, -0.006591843441128731, 0.01071791723370552), (-0.06360583752393723, -0.02776791714131832, 0.0160030797123909), (-0.026670705527067184, -0.0065322257578372955, 0.012252606451511383), (-0.06320193409919739, -0.0365605466067791, 0.0107550248503685), (-0.04262743890285492, -0.05131831765174866, 0.015503908507525921), (-0.018721051514148712, -0.016361158341169357, 0.01125669851899147), (-0.0148412324488163, -0.06375469267368317, 0.015429670922458172), (-0.007738415151834488, -0.022028079256415367, 0.011241487227380276), (-0.007581161335110664, -0.06894974410533905, 0.010728370398283005), (0.011033172719180584, -0.03758741915225983, 0.02441282570362091), (0.017918791621923447, -0.042262498289346695, 0.02541191130876541), (0.028797613456845284, -0.02907654270529747, 0.023540683090686798), (0.05370398238301277, 0.03373509645462036, 0.023684397339820862), (0.03675800934433937, -0.030666006729006767, 0.024474039673805237), (0.040040917694568634, -0.014795482158660889, 0.023337293416261673), (0.047937989234924316, -0.012621542438864708, 0.024129703640937805), (0.06373509764671326, -0.004298399202525616, 0.02238798886537552), (-0.06248130649328232, 0.022342044860124588, 0.02044907584786415), (-0.05977851152420044, 0.0014748965622857213, 0.022880103439092636), (-0.0653751790523529, -0.005452513694763184, 0.02036432921886444), (-0.0530799925327301, -0.0227595753967762, 0.02333258092403412), (-0.054722756147384644, -0.03143589198589325, 0.0204855278134346), (-0.03528590127825737, -0.04231986030936241, 0.0227527879178524), (-0.03328177332878113, -0.05103226751089096, 0.02005147561430931), (-0.012071702629327774, -0.05242692679166794, 0.02288532257080078), (-0.006360831204801798, -0.059248365461826324, 0.02049771323800087), (0.013878708705306053, -0.05098017305135727, 0.024344656616449356), (0.02206779271364212, -0.05477369576692581, 0.022012848407030106), (0.03712660074234009, -0.03957265615463257, 0.02387111820280552), (0.04289858788251877, 0.027366383001208305, 0.02728920243680477), (0.04591351002454758, -0.03980692848563194, 0.021646028384566307), (0.05229753255844116, -0.02055796980857849, 0.02351856604218483), (0.06023801490664482, -0.016900289803743362, 0.020923994481563568), (0.05077705532312393, -0.0026014945469796658, 0.025174424052238464), (-0.049998559057712555, 0.018083997070789337, 0.02412530407309532), (-0.04575023800134659, 0.001640099799260497, 0.023295823484659195), (-0.05192634463310242, -0.003940974362194538, 0.02404606342315674), (-0.040465209633111954, -0.016679979860782623, 0.023843660950660706), (-0.043249811977148056, -0.024323269724845886, 0.02421242743730545), (-0.026593614369630814, -0.03145312890410423, 0.02303425222635269), (-0.026082105934619904, -0.0397101566195488, 0.02366127073764801), (-0.00872831605374813, -0.03887593001127243, 0.02325538732111454), (-0.004617800936102867, -0.046004489064216614, 0.024157624691724777), (-0.0014838732313364744, -0.022863391786813736, 0.011565495282411575), (0.03344328701496124, 0.002808202989399433, 0.01710902713239193), (0.009001487866044044, -0.06816209852695465, 0.011578891426324844), (0.030908286571502686, -0.056773148477077484, 0.017417896538972855), (0.010872496291995049, -0.02093658223748207, 0.01182546652853489), (0.03014015592634678, 0.016282610595226288, 0.01971149444580078), (0.039851073175668716, -0.0566214919090271, 0.01240379735827446), (0.05476410314440727, -0.037923965603113174, 0.017145812511444092), (0.02074146829545498, -0.015208933502435684, 0.010972054675221443), (0.020276295021176338, 0.027298578992486, 0.019625157117843628), (0.062689408659935, -0.034003596752882004, 0.012028900906443596), (0.06739398837089539, -0.011671025305986404, 0.01638012006878853), (0.026775777339935303, -0.005251320544630289, 0.011016945354640484), (0.006468916777521372, 0.03308150917291641, 0.01910993829369545), (-0.009516667574644089, 0.033121258020401, 0.017913419753313065), (-0.022269390523433685, 0.027568932622671127, 0.01706434041261673), (-0.031098172068595886, 0.015712812542915344, 0.01677250862121582), (-0.03725942224264145, 0.013911234214901924, 0.0208742693066597), (-0.03368416428565979, 0.0019533035811036825, 0.0168018601834774), (-0.038443103432655334, -0.0022516706958413124, 0.02095785178244114), (-0.02964874915778637, -0.011377018876373768, 0.017313463613390923), (-0.0317554846405983, -0.017144445329904556, 0.021109480410814285), (-0.019184065982699394, -0.022089850157499313, 0.016239341348409653), (0.03788526728749275, -0.00090748694492504, 0.02107854001224041), (-0.01892378367483616, -0.028373107314109802, 0.020430609583854675), (-0.005840768571943045, -0.02728937193751335, 0.016477584838867188), (-0.002846239833161235, -0.03280127793550491, 0.020788094028830528), (0.008733312599360943, -0.026270871981978416, 0.017242740839719772), (0.02883603423833847, 0.005649145692586899, 0.012334529310464859), (0.013837393373250961, -0.029863961040973663, 0.02165236324071884), (0.02161598764359951, -0.020345456898212433, 0.016248593106865883), (0.02453826367855072, 0.017352890223264694, 0.01459173858165741), (0.02755775675177574, -0.021678730845451355, 0.02063416689634323), (0.029723772779107094, -0.00995427742600441, 0.01621592789888382), (0.014944691210985184, 0.025678221136331558, 0.014520255848765373), (0.0357196107506752, -0.008356578648090363, 0.02052878402173519), (0.001931139500811696, 0.02924564853310585, 0.013613373041152954), (-0.011139130219817162, 0.02833845652639866, 0.01252368651330471), (-0.02156817726790905, 0.021976007148623466, 0.011891847476363182), (0.028431743383407593, 0.0003112449194304645, 0.0113016152754426), (-0.06962582468986511, 0.016378745436668396, 0.015719743445515633), (-0.027650978416204453, 0.010984577238559723, 0.011786025017499924), (-0.07527689635753632, 0.009424403309822083, 0.01072680950164795), (-0.06928618252277374, -0.013497496023774147, 0.015691230073571205), (-0.028433319181203842, -0.0008222948526963592, 0.012024209834635258), (-0.07101312279701233, -0.022231286391615868, 0.01099037192761898), (-0.054516613483428955, -0.04034630209207535, 0.015393710695207119), (-0.023294955492019653, -0.011781739071011543, 0.011879684403538704), (-0.05204721540212631, -0.04911556467413902, 0.010483738034963608), (-0.029332272708415985, -0.0591866597533226, 0.015131460502743721), (-0.01355407852679491, -0.01987447962164879, 0.011091494001448154), (-0.023693695664405823, -0.06595485657453537, 0.010290943086147308), (0.0008567539043724537, -0.06471037119626999, 0.016001949086785316), (0.0012078039580956101, -0.03944025933742523, 0.023572994396090508), (0.00679765734821558, -0.045327603816986084, 0.02487410604953766), (0.020557299256324768, -0.03406833857297897, 0.02430793270468712), (0.02818644605576992, -0.037284575402736664, 0.024950355291366577), (0.0351610966026783, -0.02284293994307518, 0.023417526856064796), (0.043341416865587234, -0.022341564297676086, 0.024363508448004723), (0.043090857565402985, -0.00605709757655859, 0.023306306451559067), (-0.058361224830150604, 0.014019581489264965, 0.022991741076111794), (-0.06555929780006409, 0.008362381719052792, 0.020351998507976532), (-0.057895585894584656, -0.010903850197792053, 0.02304965816438198), (-0.0617271363735199, -0.018967609852552414, 0.02062251977622509), (-0.04517608880996704, -0.033228836953639984, 0.02281169779598713), (-0.044913142919540405, -0.04234032332897186, 0.02019500359892845), (-0.024264616891741753, -0.04875641688704491, 0.02251720428466797), (-0.020390380173921585, -0.056721508502960205, 0.020048849284648895), (0.0010038537438958883, -0.053214699029922485, 0.02335214987397194), (0.008091345429420471, -0.05849307030439377, 0.021309886127710342), (0.026209359988570213, -0.04636360704898834, 0.024485591799020767), (0.0349450521171093, -0.04838923364877701, 0.021854061633348465), (0.04578292369842529, -0.031094403937458992, 0.02383003756403923), (0.05447026714682579, -0.029165467247366905, 0.021436188369989395), (0.05629052594304085, -0.009189203381538391, 0.023436393588781357), (-0.04481819272041321, 0.011276742443442345, 0.023344675078988075), (-0.052203353494405746, 0.007098252419382334, 0.023996800184249878), (-0.04420416057109833, -0.007726550102233887, 0.023559873923659325), (-0.048932816833257675, -0.01456538774073124, 0.024371564388275146), (-0.03417780622839928, -0.02457546256482601, 0.02325189672410488), (-0.03531337529420853, -0.03289944306015968, 0.02380463480949402), (-0.01818627491593361, -0.036230240017175674, 0.02294870652258396), (-0.015804827213287354, -0.04408299922943115, 0.02376660704612732), (0.03282291442155838, -0.00030083185993134975, 0.016514208167791367), (0.0440545417368412, -0.0018187740352004766, 0.023970555514097214), (0.05742626637220383, -0.0035657337866723537, 0.024643156677484512), (0.06875710189342499, -0.004917967598885298, 0.018021585419774055), (0.03094075620174408, -0.006707310676574707, 0.016093023121356964), (0.041595496237277985, -0.010437902063131332, 0.023181460797786713), (0.05427820235490799, -0.014867895282804966, 0.023399412631988525), (0.0650370791554451, -0.01853937655687332, 0.01648111082613468), (0.02796938642859459, -0.012976236641407013, 0.016139216721057892), (0.03761933371424675, -0.01883060485124588, 0.023313729092478752), (0.049075718969106674, -0.025845853611826897, 0.023760918527841568), (0.058838777244091034, -0.03173654526472092, 0.01703699678182602), (0.02392083778977394, -0.018199756741523743, 0.01612793281674385), (0.03199731558561325, -0.0259811170399189, 0.02338644303381443), (0.04147791862487793, -0.03535816818475723, 0.023913636803627014), (0.04950883239507675, -0.043313656002283096, 0.017294470220804214), (0.018707191571593285, -0.022153988480567932, 0.01650743931531906), (0.024684105068445206, -0.031594403088092804, 0.023862063884735107), (0.03169254586100578, -0.043000154197216034, 0.024264471605420113), (0.03755946084856987, -0.05275480076670647, 0.01742997020483017), (0.012245066463947296, -0.02507586032152176, 0.017066754400730133), (0.01579589769244194, -0.03582882136106491, 0.02439442090690136), (0.0200648233294487, -0.04873155429959297, 0.024585381150245667), (0.02364792674779892, -0.059678539633750916, 0.017494363710284233), (0.00513669615611434, -0.026982933282852173, 0.01693883165717125), (0.006125024054199457, -0.0385245680809021, 0.023965958505868912), (0.007441733032464981, -0.05214354395866394, 0.023952404037117958), (0.008570488542318344, -0.06362417340278625, 0.016741342842578888), (-0.002162271412089467, -0.02751866541802883, 0.016515202820301056), (-0.0037567848339676857, -0.03918033093214035, 0.023331884294748306), (-0.005536248907446861, -0.052856266498565674, 0.02318173460662365), (-0.007008035201579332, -0.06438428163528442, 0.015900924801826477), (-0.009383227676153183, -0.02644488401710987, 0.016237953677773476), (-0.01345886755734682, -0.03757486492395401, 0.02301928773522377), (-0.018178442493081093, -0.0506235808134079, 0.02275984175503254), (-0.022133786231279373, -0.0616077184677124, 0.015456044115126133), (-0.01607787050306797, -0.02384369447827339, 0.016108563169836998), (-0.022400107234716415, -0.03386196866631508, 0.022904273122549057), (-0.02979164943099022, -0.04557047784328461, 0.022700175642967224), (-0.03605480492115021, -0.05538862198591232, 0.015506773255765438), (-0.022030901163816452, -0.019670706242322922, 0.016270145773887634), (-0.030400339514017105, -0.028029508888721466, 0.023061688989400864), (-0.04025382921099663, -0.03780026733875275, 0.022845450788736343), (-0.04867400974035263, -0.045940712094306946, 0.015630263835191727), (-0.02724882774055004, -0.01428334042429924, 0.01685238629579544), (-0.037331365048885345, -0.020635297521948814, 0.02352345734834671), (-0.0491664856672287, -0.02802904136478901, 0.023188957944512367), (-0.05919637903571129, -0.03416474163532257, 0.01591191627085209), (-0.031093012541532516, -0.008146417327225208, 0.017133038491010666), (-0.04234340041875839, -0.01220846176147461, 0.02369031310081482), (-0.05554528534412384, -0.01685246266424656, 0.023332754150032997), (-0.06663363426923752, -0.02070147916674614, 0.016095051541924477), (-0.03313394635915756, -0.0014778285985812545, 0.01684141904115677), (-0.044995300471782684, -0.0030495794489979744, 0.023354547098279), (-0.05887749418616295, -0.004720527678728104, 0.023043178021907806), (-0.07053963840007782, -0.006056278012692928, 0.015825442969799042), (-0.03347364068031311, 0.005466213449835777, 0.0166577510535717), (-0.04530346393585205, 0.00645951833575964, 0.023248208686709404), (-0.059108030050992966, 0.007751191034913063, 0.02301236428320408), (-0.07069870829582214, 0.008920641615986824, 0.01582571305334568), (-0.03215830400586128, 0.012356074526906013, 0.016673602163791656), (-0.04343298077583313, 0.015931572765111923, 0.02335261180996895), (-0.05646263435482979, 0.02027704566717148, 0.023117538541555405), (-0.06734052300453186, 0.02398756518959999, 0.01596866548061371), (-0.02942495234310627, 0.019065069034695625, 0.016672518104314804), (-0.02499902807176113, 0.025020591914653778, 0.016807131469249725), (-0.019270973280072212, 0.029436878859996796, 0.01706847921013832), (-0.012871881946921349, 0.03222215175628662, 0.017498092725872993), (-0.005628084763884544, 0.03348640352487564, 0.01812821254134178), (0.002372543793171644, 0.03346371278166771, 0.0187276229262352), (0.010208251886069775, 0.03203354775905609, 0.019242746755480766), (0.017120148986577988, 0.029139399528503418, 0.01949772611260414), (0.02320319414138794, 0.024757083505392075, 0.01952674612402916), (0.028130164369940758, 0.01922326534986496, 0.019600097090005875), (0.037411823868751526, 0.02429768443107605, 0.02645263448357582), (0.048499636352062225, 0.030692938715219498, 0.026332587003707886), (0.05795418471097946, 0.03625323623418808, 0.019038312137126923), (0.03149193525314331, 0.012601476162672043, 0.01910354010760784), (0.03318362310528755, 0.005872253328561783, 0.017756838351488113)]


tree = closest_neighbours(coordinates=X, neighbour_verts=NN)

#tree = KDTree(X)
#nearest_dist, nearest_ind = tree.query(X, k=2)  # k=2 nearest neighbors where k1 = identity
#print(X)
#print(nearest_dist[:, 1])  # drop id; assumes sorted -> see args!
#print(nearest_ind[:, 1])  # drop id


# Idea
# Search in the coordinates the most extreme X or Y point
# Select this point
# Add this point to a list of previously found coordinates
# Order this point, so this becomes point 0
# Search for the next nearest point on the same Z-height
# Also select this point, and reorder them so that they become 0 - 1
# Add this point to the previously found coordinates list
# Search for the next nearest point etc. until all points on Z-height have been found
# Increase Z height

# Donut 0 is at farthest positive X coordinate
#print("\nIdea")
# Find farthest X coordinate
X_coo = [x[0] for x in X]
#print("List of X coordinates:", X_coo)
# If multiple coordinates have the most extreme positive X value pick the first one
# The max() function does this automatically
max_X = max(X_coo)
max_X_index = X_coo.index(max_X)
#print("Largest X Coordinate:", max_X)
#print("And its index:", max_X_index)

# Turn on vertex
# Order point

# Search for next nearest point. Difference in Z-values gets smaller, so a specific cut off is a bad idea.
# The donut has 56 vertices per ring. So, if 56 points have been selected go to the next nearest Z-point and start anew
# A cube has 4 before the jump needs to be made to the next "ring" of 4
# So, always find the closest in X value

# Add found coordinate to list
selected_coordinates = []
selected_coordinates.append(max_X_index)
#print(selected_coordinates)

# Set up Tree to search in
#tree = KDTree(X)
#nearest_dist, nearest_ind = tree.query(X, k=len(X))

# --------------------------------
# Set up tree to search in
# Individual X, Y, Z trees
#X_coo = [x[0] for x in X]
#tree_X = KDTree(X_coo)
#Y_coo = [y[1] for y in X]
#tree_Y = KDTree(Y_coo)
#Z_coo = [z[2] for z in X]
#tree_Z = KDTree(Z_coo)

# Create the X,Y X,Z Y,Z trees
#XY_coo = list(zip(X_coo, Y_coo))
#XZ_coo = list(zip(X_coo, Z_coo))
#YZ_coo = list(zip(Y_coo, Z_coo))
#for x in range(len(X_coo)):
#    XY_coo = np.column_stack((X_coo[x], Y_coo[x]))
#    XZ_coo = [X_coo[x], Z_coo[x]]
#    YZ_coo = [Y_coo[x], Z_coo[x]]

#XY_tree = KDTree(XY_coo)
#XZ_tree = KDTree(XZ_coo)
#YZ_tree = KDTree(YZ_coo)

#nearest_dist, nearest_ind = tree.query(plain_verts, k=len(plain_verts))
#print("IND:", "\n".join(str(x) for x in nearest_ind))

# Calculate each distances
#XY_nearest_dist, XY_nearest_ind = XY_tree.query(XY_coo, k=len(XY_coo))
#XZ_nearest_dist, XZ_nearest_ind = XZ_tree.query(XZ_coo, k=len(XZ_coo))
#YZ_nearest_dist, YZ_nearest_ind = YZ_tree.query(YZ_coo, k=len(YZ_coo))
#calc_average_index = []
#for i in range(len(XY_coo)):
#    xy_ind = XY_nearest_ind.tolist().index(i)
#    xz_ind = XZ_nearest_ind.index(i)
#    yz_ind = YZ_nearest_ind.index(i)
#    calc_average_index[i] = xy_ind[i] + xz_ind[i] + yz_ind[i]
# -----------------------------------

#with open('Indices.csv', 'w') as out:
#    csv_out = csv.writer(out)
#    for row in nearest_ind:
#        csv_out.writerow(row)
#print("IND:", "\n".join(str(x) for x in nearest_ind))

for x in range(0, (len(X)-1)): # Since first determines the start instead of next closest neighbour
    next = find_next_vertex(tree=X, nearest_ind=tree, selected_coordinates=selected_coordinates, loop_iteration=x)

    # Add to list
    selected_coordinates.append(next)

#print("Final:", selected_coordinates)
